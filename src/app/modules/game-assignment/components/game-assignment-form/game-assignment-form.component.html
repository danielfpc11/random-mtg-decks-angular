<main>
  <section>
    <h1>
      {{ 'gameAssignment.form.createGame' | translate }}
    </h1>
    <form [formGroup]="playerForm" (ngSubmit)="setDecks()">
      <div class="form-control">
        <label for="name">
          {{ 'gameAssignment.form.playerName' | translate }}
        </label>
        <input id="name" type="text" formControlName="name" placeholder="{{ 'gameAssignment.form.playerNamePlaceholder' | translate }}">
      </div>
      <div class="button-container">
        <button type="button" (click)="addPlayer()" id="add-player-button">
          {{ 'gameAssignment.form.add' | translate }}
        </button>
        <button [disabled]="game.players.length == 0" type="submit" id="set-decks-button">
          {{ 'gameAssignment.form.setDecks' | translate }}
        </button>
      </div>
    </form>
    <ng-container [ngTemplateOutlet]="formErrorMessages"/>
    <game-assignment-player-list [game]="game" (deletePlayerEventEmitter)="updateNameFormControlValidation(game.players)" />
    <button [disabled]="!isValidGame()" type="button" (click)="saveGame()" id="save-game-button">
      {{ 'gameAssignment.form.saveGame' | translate }}
    </button>
  </section>
</main>

<ng-template #formErrorMessages>
  <div *ngIf="getNameFormControl()?.invalid && (getNameFormControl()?.dirty || getNameFormControl()?.touched)" id="form-error-messages">
    <p *ngIf="getNameFormControl()?.errors?.['repeatedPlayerName']">
      * {{ 'gameAssignment.form.error.repeatedPlayerName' | translate }}
    </p>
    <p *ngIf="getNameFormControl()?.errors?.['playerLimitReached']">
      * {{ 'gameAssignment.form.error.playerLimitReached' | translate }}
    </p>
  </div>
</ng-template>
